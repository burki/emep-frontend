{% extends 'Base/base.html.twig' %}

{% block head %}
    <script src="{{ app.request.basepath }}/vendor/highcharts/highcharts.js"></script>
    <script src="{{ app.request.basepath }}/vendor/highcharts/modules/exporting.js"></script>
    <!--
    <script src="{{ app.request.basepath }}/vendor/highcharts/themes/sand-signika.js"></script>
    -->
    <script type="text/javascript">
    var chart;

    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                type: 'scatter',
                renderTo: 'container',
                zoomType: 'xy'
            },
            title: {
                text: 'Number of page views in {{ lang }}.wikipedia.org (past year)'
            },
            yAxis: {
                title: {
                    enabled: true,
                    text: 'Number page views (past year)'
                },
                min: 10,
                startOnTick: true,
                endOnTick: true,
                showLastLabel: true,
                type: 'logarithmic'
            },
            xAxis: {
                title: {
                    text: 'Number of exhibitions'
                },
                labels: {
                    // enabled: false
                    formatter: function() {
                        return this.value;
                    }
                }
            },
            legend: {
                enabled: false
            },
            tooltip: {
                formatter: function () {
                    return '<a target="_blank" href="{{ path('person') }}/' + decodeURIComponent(this.point.id) + '"><b>'
                      + decodeURIComponent(this.point.name) + '</b></a><br>'
                      + this.point.num + ' exhibitions, ' + this.y + ' page views';
                },
                hideDelay: 1500, // default is 500
                useHTML: true
            },
            plotOptions: {
                scatter: {
                    marker: {
                        radius: 3,
                        states: {
                            hover: {
                                enabled: true,
                                lineColor: 'rgb(100,100,100)'
                            }
                        }
                    }
                }
            },
            series: [{
                dataLabels: {
                    enabled: false,
                    style: {color: "black" }
                },
                turboThreshold: 5000,
                data: {{ data|raw }},
                color: 'rgba(128, 133, 233, .7)'
            }]

        });

    });
    </script>
{% endblock %}

{% block body %}
    <h1>Wikipedia-Statistics</h1>
    <div id="container" style="min-width: 800px; height: 400px; margin: 0 auto;"></div>
    <h2>Persons</h2>
    {% for person in persons %}
        {{ person.name }}: {{ person.y }} page views ({{ person.num }} exh.)<br />
    {% endfor %}
{% endblock %}
